#!/usr/bin/env bash
set -e

export NIX_CONFIG="experimental-features = nix-command flakes"

# Check if home-manager is installed
if command -v home-manager &> /dev/null; then
    # home-manager is installed, use it directly
    home-manager switch --flake .#ncrmro@ncrmro-macbook -b backup
else
    # home-manager not installed yet, bootstrap it via nix run
    echo "home-manager not found in PATH, bootstrapping via nix run..."
    nix run home-manager/master -- switch --flake .#ncrmro@ncrmro-macbook -b backup
fi
